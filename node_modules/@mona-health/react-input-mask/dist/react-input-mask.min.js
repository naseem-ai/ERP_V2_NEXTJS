!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("react")):"function"==typeof define&&define.amd?define(["react"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).ReactInputMask=t(e.React)}(this,(function(e){"use strict";function t(){return t=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},t.apply(this,arguments)}function n(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function i(e){return requestAnimationFrame(e)}function r(e){cancelAnimationFrame(e)}function a(e){var t=e.ownerDocument;return t.hasFocus()&&t.activeElement===e}function o(e){return null==e?void 0:e.ownerDocument}function l(e){var t=function(e){var t;return null==(t=o(e))?void 0:t.defaultView}(e);return!!t&&e instanceof t.HTMLElement}function u(t){return e.useCallback((function(){var e=t.current,n="undefined"!=typeof window&&l(e);if(!e||!n)return null;if("INPUT"!==e.nodeName&&(e=e.querySelector("input")),!e)throw new Error("react-input-mask: inputComponent doesn't contain input node");return e}),[t])}function s(t,n){var o,l,s,c,f=e.useRef({start:null,end:null}),h=u(t),g=e.useCallback((function(){return function(e){var t=e.selectionStart,n=e.selectionEnd;return{start:t,end:n,length:n-t}}(h())}),[h]),d=e.useCallback((function(){return f.current}),[]),v=e.useCallback((function(e){var t=h();t&&a(t)&&(!function(e,t,n){void 0===n&&(n=t),e.setSelectionRange(t,n)}(t,e.start,e.end),f.current=g())}),[h,g]),m=e.useCallback((function(){f.current=g()}),[g]),p=(o=m,l=e.useRef(null),s=e.useCallback((function(){null===l.current&&function e(){o(),l.current=i(e)}()}),[o]),c=e.useCallback((function(){r(l.current),l.current=null}),[]),e.useEffect((function(){l.current&&(c(),s())}),[s,c]),e.useEffect(r,[]),[s,c]),k=p[0],P=p[1];return e.useLayoutEffect((function(){if(n){var e=h();return e.addEventListener("focus",k),e.addEventListener("blur",P),a(e)&&k(),function(){e.removeEventListener("focus",k),e.removeEventListener("blur",P),P()}}})),{getSelection:g,getLastSelection:d,setSelection:v}}function c(t,n){var i=e.useRef(),r=s(i,n),a=r.getSelection,o=r.getLastSelection,l=r.setSelection,c=function(t,n){var i=u(t),r=e.useRef(n);return{getValue:e.useCallback((function(){return i().value}),[i]),getLastValue:e.useCallback((function(){return r.current}),[]),setValue:e.useCallback((function(e){r.current=e;var t=i();t&&(t.value=e)}),[i])}}(i,t),f=c.getValue,h=c.getLastValue,g=c.setValue;return{inputRef:i,getInputState:function(){return{value:f(),selection:a()}},getLastInputState:function(){return{value:h(),selection:o()}},setInputState:function(e){var t=e.value,n=e.selection;g(t),l(n)}}}var f=n((function(e,t,n,i,r,a,o,l){if(!e){var u;if(void 0===t)u=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var s=[n,i,r,a,o,l],c=0;(u=new Error(t.replace(/%s/g,(function(){return s[c++]})))).name="Invariant Violation"}throw u.framesToPop=1,u}})),h=["disabled","onBlur","onChange","onFocus","onMouseDown","readOnly","value"],g={9:/[0-9]/,a:/[A-Za-z]/,"*":/[A-Za-z0-9]/};var d=function(e){var t=this;this.isCharacterAllowedAtPosition=function(e,n){var i=t.maskOptions.maskPlaceholder;return!!t.isCharacterFillingPosition(e,n)||!!i&&i[n]===e},this.isCharacterFillingPosition=function(e,n){var i=t.maskOptions.mask;if(!e||n>=i.length)return!1;if(!t.isPositionEditable(n))return i[n]===e;var r=i[n];return new RegExp(r).test(e)},this.isPositionEditable=function(e){var n=t.maskOptions,i=n.mask,r=n.permanents;return e<i.length&&-1===r.indexOf(e)},this.isValueEmpty=function(e){return e.split("").every((function(e,n){return!t.isPositionEditable(n)||!t.isCharacterFillingPosition(e,n)}))},this.isValueFilled=function(e){return t.getFilledLength(e)===t.maskOptions.lastEditablePosition+1},this.getDefaultSelectionForValue=function(e){var n=t.getFilledLength(e),i=t.getRightEditablePosition(n);return{start:i,end:i}},this.getFilledLength=function(e){return function(e,t){for(var n=e.length-1;n>=0;n--)if(t(e[n],n))return n;return-1}(e.split(""),(function(e,n){return t.isPositionEditable(n)&&t.isCharacterFillingPosition(e,n)}))+1},this.getStringFillingLengthAtPosition=function(e,n){return e.split("").reduce((function(e,n){return t.insertCharacterAtPosition(e,n,e.length)}),function(e,t){void 0===t&&(t=1);for(var n="",i=0;i<t;i++)n+=e;return n}(" ",n)).length-n},this.getLeftEditablePosition=function(e){for(var n=e;n>=0;n--)if(t.isPositionEditable(n))return n;return null},this.getRightEditablePosition=function(e){for(var n=t.maskOptions.mask,i=e;i<n.length;i++)if(t.isPositionEditable(i))return i;return null},this.formatValue=function(e){var n=t.maskOptions,i=n.maskPlaceholder,r=n.mask;if(!i){for(e=t.insertStringAtPosition("",e,0);e.length<r.length&&!t.isPositionEditable(e.length);)e+=r[e.length];return e}return t.insertStringAtPosition(i,e,0)},this.clearRange=function(e,n,i){if(!i)return e;var r=n+i,a=t.maskOptions,o=a.maskPlaceholder,l=a.mask,u=e.split("").map((function(e,i){var a=t.isPositionEditable(i);return!o&&i>=r&&!a?"":i<n||i>=r?e:a?o?o[i]:"":l[i]})).join("");return t.formatValue(u)},this.insertCharacterAtPosition=function(e,n,i){var r=t.maskOptions,a=r.mask,o=r.maskPlaceholder;if(i>=a.length)return e;var l=t.isCharacterAllowedAtPosition(n,i),u=t.isPositionEditable(i),s=t.getRightEditablePosition(i),c=o&&s?n===o[s]:null,f=e.slice(0,i);!l&&u||(e=f+(l?n:a[i]));return l||u||c||(e=t.insertCharacterAtPosition(e,n,i+1)),e},this.insertStringAtPosition=function(e,n,i){var r=t.maskOptions,a=r.mask,o=r.maskPlaceholder;if(!n||i>=a.length)return e;var l=n.split(""),u=t.isValueFilled(e)||!!o,s=e.slice(i);if(e=l.reduce((function(e,n){return t.insertCharacterAtPosition(e,n,e.length)}),e.slice(0,i)),u)e+=s.slice(e.length-i);else if(t.isValueFilled(e))e+=a.slice(e.length).join("");else{e=s.split("").filter((function(e,n){return t.isPositionEditable(i+n)})).reduce((function(e,n){var i=t.getRightEditablePosition(e.length);return null===i?e:(t.isPositionEditable(e.length)||(e+=a.slice(e.length,i).join("")),t.insertCharacterAtPosition(e,n,e.length))}),e)}return e},this.processChange=function(e,n){var i=t.maskOptions,r=i.mask,a=i.prefix,o=i.lastEditablePosition,l=e.value,u=e.selection,s=n.value,c=n.selection,f=l,h="",g=0,d=0,v=Math.min(c.start,u.start);if(u.end>c.start?(h=f.slice(c.start,u.end),d=(g=t.getStringFillingLengthAtPosition(h,v))?c.length:0):f.length<s.length&&(d=s.length-f.length),f=s,d){if(1===d&&!c.length)v=c.start===u.start?t.getRightEditablePosition(u.start):t.getLeftEditablePosition(u.start);f=t.clearRange(f,v,d)}return f=t.insertStringAtPosition(f,h,v),(v+=g)>=r.length?v=r.length:v<a.length&&!g?v=a.length:v>=a.length&&v<o&&g&&(v=t.getRightEditablePosition(v)),{value:f=t.formatValue(f),enteredString:h,selection:{start:v,end:v}}},this.maskOptions=function(e){var t=e.mask,n=e.maskPlaceholder,i=[];if(!t)return{maskPlaceholder:null,mask:null,prefix:null,lastEditablePosition:null,permanents:[]};if("string"==typeof t){var r=!1,a="";t.split("").forEach((function(e){r||"\\"!==e?(!r&&g[e]||i.push(a.length),a+=e,r=!1):r=!0})),t=a.split("").map((function(e,t){return-1===i.indexOf(t)?g[e]:e}))}else t.forEach((function(e,t){"string"==typeof e&&i.push(t)}));n&&(n=1===n.length?t.map((function(e,t){return-1!==i.indexOf(t)?e:n})):n.split(""),i.forEach((function(e){n[e]=t[e]})),n=n.join(""));for(var o=i.filter((function(e,t){return e===t})).map((function(e){return t[e]})).join(""),l=t.length-1;-1!==i.indexOf(l);)l--;return{maskPlaceholder:n,prefix:o,mask:t,lastEditablePosition:l,permanents:i}}(e)},v=["alwaysShowMask","children","mask","maskPlaceholder","beforeMaskedStateChange"],m=e.forwardRef((function(n,r){var l=n.alwaysShowMask,s=n.children,g=n.mask,m=n.maskPlaceholder,p=n.beforeMaskedStateChange,k=function(e,t){if(null==e)return{};var n,i,r={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(n,v);!function(e){var t=e.mask,n=e.maskPlaceholder;t&&n&&1!==n.length&&n.length!==t.length&&f(!1)}(n);var P,b,E=new d({mask:g,maskPlaceholder:m}),S=!!g,C=!k.disabled&&!k.readOnly,w=null!==n.value&&void 0!==n.value,y=(P=S,b=e.useRef(),e.useEffect((function(){b.current=P})),b.current),V=function(e){return""+e}((w?n.value:n.defaultValue)||""),F=c(V,S),O=F.inputRef,L=F.getInputState,R=F.setInputState,A=F.getLastInputState,M=u(O);if(S&&w){var x=M(),D=x&&a(x)||l||n.value?E.formatValue(n.value):n.value;p&&(D=p({nextState:{value:D,selection:{start:null,end:null}}}).value),R(t({},A(),{value:D}))}var j=A(),I=j.selection,T=j.value;e.useLayoutEffect((function(){if(S){var e=M();if(e){var n=a(e),i=I,r=L(),o=t({},r);if(!w){var u=r.value,s=E.formatValue(u),c=E.isValueEmpty(s);!c||n||l?o.value=s:c&&!n&&(o.value="")}n&&!y?o.selection=E.getDefaultSelectionForValue(o.value):w&&n&&i&&null!==i.start&&null!==i.end&&(o.selection=i),p&&(o=p({currentState:r,nextState:o})),R(o)}}}));var B=function(e){O.current=e,!function(e){return"function"==typeof e}(r)?null!==r&&"object"==typeof r&&(r.current=e):r(e)},q=t({},k,{onFocus:function(e){O.current=e.target;var t=L().value;if(S&&!E.isValueFilled(t)){var r=E.formatValue(t),a=E.getDefaultSelectionForValue(r),o={value:r,selection:a};p&&(r=(o=p({currentState:L(),nextState:o})).value,a=o.selection),R(o),r!==t&&n.onChange&&n.onChange(e),i((function(){R(A())}))}n.onFocus&&n.onFocus(e)},onBlur:function(e){var t=L().value,i=A().value;if(S&&!l&&E.isValueEmpty(i)){var r="",a={value:r,selection:{start:null,end:null}};p&&(r=(a=p({currentState:L(),nextState:a})).value),R(a),r!==t&&n.onChange&&n.onChange(e)}n.onBlur&&n.onBlur(e)},onChange:S&&C?function(e){var t=L(),i=A(),r=E.processChange(t,i);p&&(r=p({currentState:t,previousState:i,nextState:r})),R(r),n.onChange&&n.onChange(e)}:n.onChange,onMouseDown:S&&C?function(e){var i=M();if(i){var r=L().value,l=o(i);if(!a(i)&&!E.isValueFilled(r)){var u=e.clientX,s=e.clientY,c=(new Date).getTime();l.addEventListener("mouseup",(function e(n){if(l.removeEventListener("mouseup",e),a(i)){var r=Math.abs(n.clientX-u),o=Math.abs(n.clientY-s),f=Math.max(r,o),h=(new Date).getTime()-c;if(f<=10&&h<=200||f<=5&&h<=300){var g=A(),d=t({},g,{selection:E.getDefaultSelectionForValue(g.value)});R(d)}}}))}n.onMouseDown&&n.onMouseDown(e)}}:n.onMouseDown,value:S&&w?T:n.value});if(s){!function(e,t){h.filter((function(n){return null!=t.props[n]&&t.props[n]!==e[n]})).length&&f(!1)}(n,s);var N=e.Children.only(s);return e.cloneElement(N,t({},q,{ref:B}))}return e.createElement("input",t({ref:B},q))}));return m.displayName="InputMask",m.defaultProps={alwaysShowMask:!1,maskPlaceholder:"_"},m}));
